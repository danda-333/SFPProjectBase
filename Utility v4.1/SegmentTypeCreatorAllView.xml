<?xml version="1.0" encoding="utf-8"?>
<DataView  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:dsp="http://www.gappex.com/sfp/DataSource/Parameters" Ident="SegmentTypeCreatorAllView" SegmentType="Admin" TitleResourceKey="SegmentTypeCreatorAllView_Utility" GroupTitleResourceKey="UtilityGroup" Priority="30" PackageIdent="Utility" IsCheckBox="true" DefaultFilterIdent="SegmentTypeCreatorFilter" ShareFilterIdent="SegmentTypeCreatorFilter">
  <AccessPermissions>
    <string>SuperAdmin</string>
  </AccessPermissions>
  <Buttons>
    <Button xsi:type="LinkButton" Ident="AddButton" FormIdent="SegmentTypeCreator" TitleResourceKey="AddButton_Utility" />
    <Button xsi:type="LinkButton" Ident="RecountPermissions" TitleResourceKey="RecountPermissions_Utility" Url="~/Clear/RecountPermissions"></Button>
    <Button xsi:type="LinkButton" Ident="Clear" TitleResourceKey="Clear_Utility" Url="~/Clear"></Button>
  </Buttons>
  <DataSource>
		<Columns>
      <Column Ident="Row" IsPrimaryKey="true" IsVisible="false" />
			<Column Ident="ID" TitleResourceKey="ID_Utility" Width="20" />
      <Column Ident="ASPNETRoleID" TitleResourceKey="ASPNETRoleID_Utility" Width="72" />
      <Column Ident="Copy" TitleResourceKey="CopyToImport_Utility" Width="8" />
		</Columns>
		<SQL>

      SELECT *
      FROM (
        SELECT 
          ROW_NUMBER() OVER(ORDER BY seg.ID ASC) AS Row
          ,CONCAT('<a href="../../Form/Index/SegmentTypeCreator?OldID=', seg.ID, '">', seg.ID, '</a>') AS ID
          ,rol.ASPNETRoleID
          ,CONCAT(
            '<button type="button" class="btn btn-outline bg-pink-400 text-pink-800 btn-icon rounded-round ml-2" onclick="const elem=document.createElement(''textarea'');elem.value='''
              ,seg.ID
              ,';'
              ,rol.PermissionID
            ,''' + String.fromCharCode(13),document.body.appendChild(elem),elem.select(),document.execCommand(''copy''),document.body.removeChild(elem);"><i class="icon-copy3"></i></button>'
          ) AS Copy
        FROM dbo.SegmentType AS seg
        LEFT JOIN dbo.Role AS rol ON rol.ASPNETRoleID = seg.ASPNETRoleID
      ) AS tbl
      WHERE 1 = 1 #FILTER#
      
    </SQL>
		<Parameters>
			<dsp:Parameter xsi:type="dsp:ValueParameter" Ident="DeleteState" DataType="Number" Value="0" />
		</Parameters>
	</DataSource>

  <Sections>
    <Section xsi:type="ExportSection" Ident="BasicExportSection"  TitleResourceKey="BasicExport_Utility" >
      <DataSource>
        <Columns>
          <Column Ident="Row" IsPrimaryKey="true" IsVisible="false" />
          <Column Ident="ID" TitleResourceKey="ID_Utility" />
          <Column Ident="PermissionID" TitleResourceKey="PermissionID_Utility"/>
        </Columns>
        <SQL>
          SELECT *
          FROM (
            SELECT 
              ROW_NUMBER() OVER(ORDER BY seg.ID ASC) AS Row
              ,seg.ID
              ,rol.PermissionID
            FROM dbo.SegmentType AS seg
            LEFT JOIN dbo.Role AS rol ON rol.ASPNETRoleID = seg.ASPNETRoleID
          ) AS tbl
          WHERE 1 = 1 #FILTER#
        </SQL>
        <Parameters>
          <dsp:Parameter xsi:type="dsp:ValueParameter" Ident="DeleteState" DataType="Number" Value="0" />
        </Parameters>
      </DataSource>
    </Section>
  </Sections>
    
</DataView>
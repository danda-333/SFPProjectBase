<?xml version="1.0" encoding="utf-8"?>
<Library xmlns:xsd="http://www.w3.org/2001/XMLSchema" Ident="SplitString" LibraryType="Function" PackageIdent="Utility">
	<Description>
		Fallback pro SPLIT_STRING
	</Description>
	<Command>

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

#MODIFIER# FUNCTION #NAME#
(
	@string    nvarchar(max),
	@delimiter nvarchar(max)
)
RETURNS TABLE AS RETURN
(
    SELECT 
        Split.a.value('let $n := . return count(../*[. << $n]) + 1', 'int') AS id
      , Split.a.value('.', 'NVARCHAR(MAX)')                                 AS value
    FROM
    (
        SELECT CAST('<X>'+REPLACE(@string, @delimiter, '</X><X>')+'</X>' AS XML) AS String
    ) AS a
    CROSS APPLY String.nodes('/X') AS Split(a)
)




	</Command>
</Library>
<?xml version="1.0" encoding="utf-8"?>
<DataView  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:dsp="http://www.gappex.com/sfp/DataSource/Parameters" Ident="PermissionTableAllView" SegmentType="Admin" TitleResourceKey="PermissionTableAllView_Utility" GroupTitleResourceKey="UtilityGroup" Priority="50" PackageIdent="Utility" DefaultFilterIdent="PermissionTableFilter" ShareFilterIdent="PermissionTableFilter">
  <AccessPermissions>
    <string>SuperAdmin</string>
  </AccessPermissions>
  <Buttons>
    <Button xsi:type="LinkButton" Ident="RecountPermissions" TitleResourceKey="RecountPermissions_Utility" Url="~/Clear/RecountPermissions"></Button>
    <Button xsi:type="LinkButton" Ident="Clear" TitleResourceKey="Clear_Utility" Url="~/Clear"></Button>
  </Buttons>
  <DataSource>
		<Columns>
			<Column Ident="AccountID" TitleResourceKey="AccountID_Utility" Width="25" />
      <Column Ident="PermissionID" TitleResourceKey="PermissionID_Utility" Width="25" />
      <Column Ident="FormIdent" TitleResourceKey="FormIdent_Utility" Width="25" />
      <Column Ident="TableID" TitleResourceKey="TableID_Utility" Width="25" />
		</Columns>
		<SQL>
      SELECT 
        CONCAT(acc.FullName, ' (', acc.ID, ')') AS AccountID
        ,tbl.PermissionID
        ,ISNULL(tbl.FormIdent, 'NULL') AS FormIdent
        ,IIF(tbl.TableID < 0, 'NULL', CAST(tbl.TableID AS VARCHAR(100)) ) AS TableID
      FROM(
        SELECT 
          AccountID
          ,PermissionID
          ,FormIdent
          ,TableID AS TableID
        FROM dbo.AccountComputedPermissionComputed

        UNION 
        
        SELECT 
          AccountID
          ,PermissionID
          ,NULL AS FormIdent
          ,-1 AS TableID
        FROM dbo.AccountPermissionStaticComputed
      ) AS tbl
      INNER JOIN dbo.Account AS acc ON acc.ID = tbl.AccountID
      WHERE 1 = 1 #FILTER#

    </SQL>
		<Parameters>
			<dsp:Parameter xsi:type="dsp:ValueParameter" Ident="DeleteState" DataType="Number" Value="0" />
		</Parameters>
	</DataSource>
</DataView>